<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>TACTIQA - Portal</title>
  <link rel="stylesheet" href="styles.css" />
</head>

<body>
  <div class="bg"></div>

  <main id="view-login" class="view active">
    <section class="card login-card">
      <div class="brand">
        <img class="brand-logo" src="logo.jpg" alt="TACTIQA" onerror="this.style.display='none'"/>
        <div class="brand-sub"><span class="lock"></span> Iniciar sesión</div>
      </div>

      <form class="form" id="loginForm">
        <div class="field">
          <input id="loginUser" type="text" placeholder="Usuario" autocomplete="username" />
        </div>
        <div class="field">
          <input id="loginPass" type="password" placeholder="Clave" autocomplete="current-password" />
        </div>

        <button class="btn primary full" type="submit">
          <span class="icon">⮕</span> Ingresar
        </button>

        <div class="links-row single">
          <a href="nuevo-cliente.html"> Crear nuevo cliente</a>
          <a href="#">¿Olvidaste tu contraseña?</a>
        </div>

        <div class="note" id="loginMsg" style="display:none; color:red; margin-top:10px;"></div>
      </form>
    </section>
  </main>

  <script src="auth.js"></script>
  
  <script>
    document.getElementById('loginForm').addEventListener('submit', (e) => {
        e.preventDefault(); // Evita que la página se recargue

        const u = document.getElementById('loginUser').value.trim();
        const p = document.getElementById('loginPass').value.trim();
        const msg = document.getElementById('loginMsg');
        
        msg.style.display = 'none';

        if(!u || !p) {
            msg.textContent = "Ingrese usuario y contraseña.";
            msg.style.display = 'block';
            return;
        }

        // Verifica si auth.js cargó correctamente
        if (typeof loginUser !== 'function') {
            alert("Error: El archivo auth.js no se ha cargado. Verifica que el archivo exista en la carpeta.");
            return;
        }

        const result = loginUser(u, p);

        if (result.success) {
            window.location.href = "menu.html";
        } else {
            msg.textContent = result.message;
            msg.style.display = 'block';
        }
    });
  </script>
</body>
</html>